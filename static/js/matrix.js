!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),o=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+o)},o);return e=n+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var M={settings:{COL_WIDTH:20,COL_HEIGHT:25,VELOCITY_PARAMS:{min:4,max:8},CODE_LENGTH_PARAMS:{min:20,max:40}},animation:null,c:null,ctx:null,lineC:null,ctx2:null,WIDTH:window.innerWidth,HEIGHT:window.innerHeight,COLUMNS:null,canvii:[],font:"30px matrix-code",letters:paincompiler.split(""),codes:[],createCodeLoop:null,codesCounter:0,init:function(){M.c=document.getElementById("canvas"),M.ctx=M.c.getContext("2d"),M.c.width=M.WIDTH,M.c.height=M.HEIGHT,M.ctx.shadowBlur=0,M.ctx.fillStyle="#000",M.ctx.fillRect(0,0,M.WIDTH,M.HEIGHT),M.ctx.font=M.font,M.COLUMNS=Math.ceil(M.WIDTH/M.settings.COL_WIDTH);for(var e=0;e<M.COLUMNS;e++)M.codes[e]=[],M.codes[e][0]={open:!0,position:{x:0,y:0},strength:0};M.loop(),M.createLines(),M.createCode(),window.onresize=function(){window.cancelAnimationFrame(M.animation),M.animation=null,M.ctx.clearRect(0,0,M.WIDTH,M.HEIGHT),M.codesCounter=0,M.ctx2.clearRect(0,0,M.WIDTH,M.HEIGHT),M.WIDTH=window.innerWidth,M.HEIGHT=window.innerHeight,M.init()}},loop:function(){M.animation=requestAnimationFrame(function(){M.loop()}),M.draw()},draw:function(){var e,t,n,o,i,a;M.ctx.shadowColor="rgba(0, 0, 0, 0.5)",M.ctx.fillStyle="rgba(0, 0, 0, 0.5)",M.ctx.fillRect(0,0,M.WIDTH,M.HEIGHT),M.ctx.globalCompositeOperation="source-over";for(var s=0;s<M.COLUMNS;s++)M.codes[s][0].canvas&&(e=M.codes[s][0].velocity,t=M.codes[s][0].canvas.height,n=M.codes[s][0].position.x,o=M.codes[s][0].position.y-t,i=M.codes[s][0].canvas,a=i.getContext("2d"),M.ctx.drawImage(i,n,o,M.settings.COL_WIDTH,t),M.codes[s][0].position.y-t<M.HEIGHT?M.codes[s][0].position.y+=e:M.codes[s][0].position.y=0)},createCode:function(){if(M.codesCounter>M.COLUMNS)return void clearTimeout(M.createCodeLoop);var e=M.randomFromInterval(0,100),t=M.assignColumn();if(t){var n=(M.randomFromInterval(M.settings.CODE_LENGTH_PARAMS.min,M.settings.CODE_LENGTH_PARAMS.max),Math.random()*(M.settings.VELOCITY_PARAMS.max-M.settings.VELOCITY_PARAMS.min)+M.settings.VELOCITY_PARAMS.min);M.codes[t][0].position={x:t*M.settings.COL_WIDTH,y:0},M.codes[t][0].velocity=n,M.codes[t][0].strength=M.codes[t][0].velocity/M.settings.VELOCITY_PARAMS.max;for(var o=1;o<=M.letters.length;o++)M.codes[t][o]=M.letters[o-1];M.createCanvii(t),M.codesCounter++}M.createCodeLoop=setTimeout(M.createCode,e)},createCanvii:function(e){var t,n,o=M.codes[e].length-1,i=o*M.settings.COL_HEIGHT,a=(M.codes[e][0].velocity,M.codes[e][0].strength),s=document.createElement("canvas"),c=s.getContext("2d");s.width=M.settings.COL_WIDTH,s.height=i;for(var r=1;o>r;r++)t=M.codes[e][r],c.globalCompositeOperation="source-over",c.font="30px matrix-code",5>r?(c.shadowColor="hsl(104, 79%, 74%)",c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=10,c.fillStyle="hsla(104, 79%, "+(100-5*r)+"%, "+a+")"):r>o-4?(n=r/o,n=1-n,c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.fillStyle="hsla(104, 79%, 74%, "+(n+.3)+")"):(c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.fillStyle="hsla(104, 79%, 74%, "+a+")"),c.fillText(t,0,i-r*M.settings.COL_HEIGHT);M.codes[e][0].canvas=s},swapCharacters:function(){for(var e,t,n,o,i,a,s=0;20>s;s++)e=M.randomFromInterval(0,M.codes.length-1),t=M.codes[e],n=t.length,o=M.randomFromInterval(2,n-1),i=M.randomFromInterval(0,M.letters.length-1),a=M.letters[i],t[o]=a;M.swapCharacters()},createLines:function(){M.linesC=document.createElement("canvas"),M.linesC.width=M.WIDTH,M.linesC.height=M.HEIGHT,M.linesC.style.position="absolute",M.linesC.style.top=0,M.linesC.style.left=0,M.linesC.style.zIndex=10,document.body.appendChild(M.linesC);var e=0,t=0;for(M.ctx2=M.linesC.getContext("2d"),M.ctx2.beginPath(),M.ctx2.lineWidth=1,M.ctx2.strokeStyle="rgba(0, 0, 0, 0.7)";e<M.HEIGHT;)M.ctx2.moveTo(0,e),M.ctx2.lineTo(M.WIDTH,e),e+=5;for(M.ctx2.lineWidth=.15,M.ctx2.strokeStyle="rgba(255, 255, 255, 0.7)";t<M.HEIGHT;)M.ctx2.moveTo(0,t+1),M.ctx2.lineTo(M.WIDTH,t+1),t+=5;M.ctx2.stroke()},assignColumn:function(){var e=M.randomFromInterval(0,M.COLUMNS-1);return M.codes[e][0].open?(M.codes[e][0].open=!1,e):!1},randomFromInterval:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},snapshot:function(){window.open(M.c.toDataURL())}};window.onload=function(){M.init()};